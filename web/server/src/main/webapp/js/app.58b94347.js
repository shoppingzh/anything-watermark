(function(t){function e(e){for(var o,i,r=e[0],l=e[1],c=e[2],f=0,p=[];f<r.length;f++)i=r[f],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&p.push(s[i][0]),s[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,i=1;i<n.length;i++){var l=n[i];0!==s[l]&&(o=!1)}o&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var o={},s={app:0},a=[];function i(t){return r.p+"js/"+({pdfjsWorker:"pdfjsWorker"}[t]||t)+"."+{pdfjsWorker:"0d4aae55"}[t]+".js"}function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(t){var e=[],n=s[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,o){n=s[t]=[e,o]}));e.push(n[2]=o);var a,l=document.createElement("script");l.charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.src=i(t);var c=new Error;a=function(e){l.onerror=l.onload=null,clearTimeout(f);var n=s[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",c.name="ChunkLoadError",c.type=o,c.request=a,n[1](c)}s[t]=void 0}};var f=setTimeout((function(){a({type:"timeout",target:l})}),12e4);l.onerror=l.onload=a,document.head.appendChild(l)}return Promise.all(e)},r.m=t,r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var f=0;f<l.length;f++)e(l[f]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("85ec"),s=n.n(o);s.a},1:function(t,e){},2:function(t,e){},"2e96":function(t,e,n){},3:function(t,e){},4:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Steps",{attrs:{current:t.step}},[n("Step",{attrs:{title:"选择文件",content:"支持pdf、视频、图片"}}),n("Step",{attrs:{title:"设计水印",content:"设计你想要的水印效果"}}),n("Step",{attrs:{title:"生成",content:"生成水印并下载"}})],1),n("div",{staticClass:"steps"},[n("div",{directives:[{name:"show",rawName:"v-show",value:0===t.step,expression:"step === 0"}],staticClass:"steps__item"},[0===t.step?n("Upload",{attrs:{type:"drag",action:"/file/upload","on-success":t.handleUploaded,"on-error":t.handleUploadError}},[n("div",{staticStyle:{padding:"60px 0"}},[n("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),n("p",[t._v("选择一个文件或将文件拖动至此")]),n("p",[n("Tag",{attrs:{type:"border",color:"primary"}},[t._v("PDF")]),t._v(" "),n("Tag",{attrs:{type:"border",color:"warning"}},[t._v("视频")]),t._v(" "),n("Tag",{attrs:{type:"border",color:"success"}},[t._v("图片")]),t._v(" "),n("Tag",{attrs:{type:"border",color:"purple"}},[t._v("Word")])],1)],1)]):t._e()],1),n("div",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}],staticClass:"steps__item",staticStyle:{position:"relative"}},[n("watermark-designer",{ref:"designer",on:{designEnd:t.handleDesignEnd}}),t.designing?n("Spin",{attrs:{size:"large",fix:""}}):t._e()],1),n("div",{directives:[{name:"show",rawName:"v-show",value:2===t.step,expression:"step === 2"}],staticClass:"steps__item"},[t.result?n("div",{staticClass:"result-box",on:{mouseenter:function(e){t.moreAction=!0},mouseleave:function(e){t.moreAction=!1}}},["image"==t.resultType?n("img",{attrs:{src:t.resultSrc}}):"video"==t.resultType?n("video",{attrs:{src:t.resultSrc,controls:""}}):"pdf"==t.resultType?n("div",{staticStyle:{height:"100%",overflow:"auto"}},[n("pdf",{attrs:{src:t.resultSrc}})],1):n("a",{attrs:{href:"/watermark/"+t.result,target:"_blank"}},[t._v(" "+t._s(t.result)+" ")]),n("Row",{directives:[{name:"show",rawName:"v-show",value:t.moreAction,expression:"moreAction"}],staticClass:"result-box__overlay",attrs:{type:"flex"}},[n("i-col",{staticClass:"result-box__overlay__item",staticStyle:{"background-color":"rgba(255, 153, 0, .75)"},attrs:{span:12},nativeOn:{click:function(e){return t.handleDownload(e)}}},[n("Row",{staticClass:"result-box__action",attrs:{type:"flex",align:"middle",justify:"center"}},[n("div",[n("Icon",{attrs:{type:"md-download",size:40}}),t._v(" 下载 ")],1)])],1),n("i-col",{staticClass:"result-box__overlay__item",staticStyle:{"background-color":"rgba(25, 190, 107, .75)"},attrs:{span:12},nativeOn:{click:function(e){t.step=1}}},[n("Row",{staticClass:"result-box__action",attrs:{type:"flex",align:"middle",justify:"center"}},[n("div",[n("Icon",{attrs:{type:"md-construct",size:40}}),t._v(" 重新设计 ")],1)])],1)],1)],1):t._e()])])],1)},a=[],i=(n("baa5"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Row",[n("i-col",{attrs:{span:"16"}},[n("div",{ref:"box",staticClass:"preview-box"},[t._t("container"),n("div",{staticClass:"watermark",style:t.styles},[1==t.conf.type?n("span",{ref:"watermark",staticStyle:{"white-space":"nowrap"}},[t._v(t._s(t.conf.text))]):2==t.conf.type?n("div",[t.conf.image?n("img",{ref:"watermark",attrs:{src:t.imageUrl}}):t._e()]):t._e()])],2)]),n("i-col",{attrs:{span:"8"}},[n("Form",{attrs:{"label-width":120}},[n("FormItem",{attrs:{label:"水印类型"}},[n("RadioGroup",{model:{value:t.conf.type,callback:function(e){t.$set(t.conf,"type",e)},expression:"conf.type"}},[n("Radio",{attrs:{label:1}},[t._v("文字水印")]),n("Radio",{attrs:{label:2}},[t._v("图片水印")])],1)],1),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:1===t.conf.type,expression:"conf.type ===  1"}],scopedSlots:t._u([{key:"label",fn:function(){return[n("Icon",{attrs:{type:"ios-document-outline"}}),t._v(" 文字内容")]},proxy:!0}])},[n("i-input",{model:{value:t.conf.text,callback:function(e){t.$set(t.conf,"text",e)},expression:"conf.text"}})],1),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:1==t.conf.type,expression:"conf.type == 1"}],scopedSlots:t._u([{key:"label",fn:function(){return[n("Icon",{attrs:{type:"ios-document-outline"}}),t._v(" 文字颜色")]},proxy:!0}])},[n("ColorPicker",{attrs:{format:"hex",colors:["#333","#666","#999","#aaa","#bbb","#ccc","#ddd","#eee","#fff"]},model:{value:t.conf.textColor,callback:function(e){t.$set(t.conf,"textColor",e)},expression:"conf.textColor"}})],1),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:2==t.conf.type,expression:"conf.type == 2"}],scopedSlots:t._u([{key:"label",fn:function(){return[n("Icon",{attrs:{type:"md-image"}}),t._v(" 水印图片")]},proxy:!0}])},[n("Upload",{attrs:{action:"/file/upload","on-success":t.handleImageUploaded}},[n("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("选择文件")])],1)],1),n("FormItem",{attrs:{label:"快捷设置"}},[n("Button",{attrs:{type:"success",ghost:""},on:{click:t.handleFastDesign}},[n("Icon",{attrs:{type:"ios-hammer-outline"}}),t._v(" 打开快捷设置面板")],1)],1),n("FormItem",{attrs:{label:"水印大小"}},[n("Slider",{attrs:{min:1,max:100},model:{value:t.scaledSize,callback:function(e){t.scaledSize=e},expression:"scaledSize"}})],1),n("FormItem",{attrs:{label:"水印位置"}},[n("Row",{attrs:{type:"flex"}},[n("i-col",{attrs:{span:8}},[n("Button",{on:{click:t.handlePosLeftTop}},[t._v("左上")])],1),n("i-col",{attrs:{span:8}}),n("i-col",{attrs:{span:8}},[n("Button",{on:{click:t.handlePosRightTop}},[t._v("右上")])],1)],1),n("Row",{attrs:{type:"flex"}},[n("i-col",{attrs:{span:8}}),n("i-col",{attrs:{span:8}},[n("Button",{on:{click:t.handlePosCenter}},[t._v("中间")])],1),n("i-col",{attrs:{span:8}})],1),n("Row",{attrs:{type:"flex"}},[n("i-col",{attrs:{span:8}},[n("Button",{on:{click:t.handlePosLeftBottom}},[t._v("左下")])],1),n("i-col",{attrs:{span:8}}),n("i-col",{attrs:{span:8}},[n("Button",{on:{click:t.handlePosRightBottom}},[t._v("右下")])],1)],1),n("p",{staticStyle:{"margin-top":"5px"}},[n("Button",{staticStyle:{border:"none"},attrs:{type:"warning",size:"small",ghost:""},on:{click:function(e){t.positionSetting=!t.positionSetting}}},[n("Icon",{attrs:{type:"md-cog"}}),t._v(" "+t._s(t.positionSetting?"收起":"")+"高级设置 ")],1)],1)],1),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.positionSetting,expression:"positionSetting"}],attrs:{label:"横轴位置"}},[n("Slider",{attrs:{min:0,max:100,step:1,"show-input":""},model:{value:t.xOffset,callback:function(e){t.xOffset=e},expression:"xOffset"}})],1),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.positionSetting,expression:"positionSetting"}],attrs:{label:"横轴对齐方式"}},[n("RadioGroup",{model:{value:t.conf.xAlign,callback:function(e){t.$set(t.conf,"xAlign",e)},expression:"conf.xAlign"}},[n("Radio",{attrs:{label:1}},[t._v("左")]),n("Radio",{attrs:{label:.5}},[t._v("中")]),n("Radio",{attrs:{label:0}},[t._v("右")])],1)],1),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.positionSetting,expression:"positionSetting"}],attrs:{label:"纵轴位置"}},[n("Slider",{attrs:{min:0,max:100,step:1,"show-input":""},model:{value:t.yOffset,callback:function(e){t.yOffset=e},expression:"yOffset"}})],1),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.positionSetting,expression:"positionSetting"}],attrs:{label:"纵轴对齐方式"}},[n("RadioGroup",{model:{value:t.conf.yAlign,callback:function(e){t.$set(t.conf,"yAlign",e)},expression:"conf.yAlign"}},[n("Radio",{attrs:{label:1}},[t._v("上")]),n("Radio",{attrs:{label:.5}},[t._v("中")]),n("Radio",{attrs:{label:0}},[t._v("下")])],1)],1),n("FormItem",{attrs:{label:"旋转角度"}},[n("Slider",{attrs:{min:0,max:360,step:1,"show-input":""},model:{value:t.conf.rotation,callback:function(e){t.$set(t.conf,"rotation",e)},expression:"conf.rotation"}})],1),n("FormItem",{attrs:{label:"不透明度"}},[n("Slider",{attrs:{min:0,max:100,step:1,"show-input":""},model:{value:t.conf.opacity,callback:function(e){t.$set(t.conf,"opacity",e)},expression:"conf.opacity"}})],1),n("FormItem",[n("Button",{attrs:{type:"primary",long:""},on:{click:function(e){return t.$emit("designEnd")}}},[t._v("好了 "),n("Icon",{attrs:{type:"md-arrow-round-forward"}})],1)],1)],1),n("Modal",{attrs:{"footer-hide":"",transfer:!1},model:{value:t.fast,callback:function(e){t.fast=e},expression:"fast"}},[n("div",[n("div",{staticClass:"fast-setting__item"},[n("p",{staticClass:"fast-setting__label"},[t._v("PDF: ")]),n("Button",{attrs:{type:"primary",ghost:""},on:{click:t.handleFastPdf1}},[t._v("PDF常用水印1")]),t._v(" "),n("Button",{attrs:{type:"primary",ghost:""},on:{click:t.handleFastPdf2}},[t._v("PDF常用水印2")])],1),n("div",{staticClass:"fast-setting__item"},[n("p",{staticClass:"fast-setting__label"},[t._v("视频：")]),n("Button",{attrs:{type:"warning",ghost:""},on:{click:t.handleFastVideo1}},[t._v("视频常用水印1")])],1),n("div",{staticClass:"fast-setting__item"},[n("p",{staticClass:"fast-setting__label"},[t._v("图片：")]),n("Button",{attrs:{type:"success",ghost:""},on:{click:t.handleFastImage1}},[t._v("图片常用水印1")]),t._v(" "),n("Button",{attrs:{type:"success",ghost:""},on:{click:t.handleFastImage2}},[t._v("图片常用水印2")])],1)])])],1)],1),n("div",{staticStyle:{position:"fixed",top:"0",left:"0","margin-left":"-100%","margin-top":"-100%"}},[n("span",{ref:"textTemplate",staticStyle:{"font-size":"12px"}},[t._v(t._s(t.conf.text))])])],1)}),r=[],l={props:{},data:function(){return{conf:{type:1,x:0,y:0,xAlign:0,yAlign:0,size:.01,rotation:0,opacity:100,text:"内部使用，请勿盗版！",textColor:"#000",image:null},fast:!1,positionSetting:!1}},computed:{xOffset:{get:function(){return 100*this.conf.x},set:function(t){this.conf.x=t/100}},yOffset:{get:function(){return 100*this.conf.y},set:function(t){this.conf.y=t/100}},scaledSize:{get:function(){return 500*this.conf.size},set:function(t){this.conf.size=t/500}},imageUrl:function(){var t=this.conf.image;return t?"/upload/".concat(t):null},styles:function(){var t=this.conf;this.conf.text,this.conf.image;var e=t.type,n=this.$refs.box,o=this.$refs.watermark,s=t.size,a=t.x,i=t.y,r=t.xAlign,l=t.yAlign,c=0,f=0;if(n&&o){var u=n.offsetWidth,p=n.offsetHeight,d=o.offsetWidth,m=o.offsetHeight,v=d,h=m;if(1==e){var g=this.$refs.textTemplate;if(g){var y=g.offsetHeight;o.style.fontSize=Math.min(p,u)*s*12/y+"px"}}else if(2==e){var x=d/m;h=Math.sqrt(u*p*s/x),v=h*x,o.style.width=v+"px",o.style.height=h+"px"}c=u*a,f=p*i,c-=v*r,f-=h*l}return{transform:"rotate(".concat(t.rotation,"deg)"),opacity:t.opacity/100,color:t.textColor,left:c+"px",top:f+"px"}}},watch:{},mounted:function(){},methods:{config:function(){return Object.assign({},this.conf)},handleImageUploaded:function(t){t.success&&(this.conf.image=t.data,this.conf.size=8)},handleFastDesign:function(){this.fast=!0},handlePosLeftTop:function(){var t=this.conf;t.x=0,t.y=0,t.xAlign=0,t.yAlign=0},handlePosRightTop:function(){var t=this.conf;t.x=1,t.y=0,t.xAlign=1,t.yAlign=0},handlePosCenter:function(){var t=this.conf;t.x=.5,t.y=.5,t.xAlign=.5,t.yAlign=.5},handlePosLeftBottom:function(){var t=this.conf;t.x=0,t.y=1,t.xAlign=0,t.yAlign=1},handlePosRightBottom:function(){var t=this.conf;t.x=1,t.y=1,t.xAlign=1,t.yAlign=1},handleFastPdf1:function(){this.fast=!1;var t=this.conf;t.x=.5,t.y=.5,t.xAlign=.5,t.yAlign=.5,t.textColor="#666",t.rotation=30,t.opacity=70,t.size=.05},handleFastPdf2:function(){this.fast=!1;var t=this.conf;t.x=.95,t.y=.1,t.xAlign=1,t.yAlign=1,t.rotation=0,t.opacity=70,t.textColor="#666",t.size=.05},handleFastVideo1:function(){this.fast=!1;var t=this.conf;t.x=.95,t.y=.95,t.xAlign=1,t.yAlign=1,t.rotation=0,t.opacity=50,t.textColor="#666"},handleFastImage1:function(){this.fast=!1;var t=this.conf;t.x=.5,t.y=1,t.xAlign=.5,t.yAlign=1,t.textColor="#fff",t.rotation=0,t.opacity=95},handleFastImage2:function(){this.fast=!1,this.handleFastImage1();var t=this.conf;t.x=1,t.xAlign=1}}},c=l,f=(n("66b2"),n("2877")),u=Object(f["a"])(c,i,r,!1,null,"4003ff39",null),p=u.exports,d=(n("d3b7"),n("bc3a")),m=n.n(d),v=m.a.create({baseURL:"",timeout:6e6});v.interceptors.response.use((function(t){return t.data}),(function(t){return Promise.reject(t)}));var h=v,g=n("858e"),y={name:"App",components:{WatermarkDesigner:p,pdf:g["a"]},data:function(){return{step:0,designing:!1,src:null,result:null,moreAction:!1}},computed:{resultType:function(){var t=this.result;if(!t)return null;var e=t.substring(t.lastIndexOf(".")+1);return"pdf"==e?"pdf":"docx"==e?"word":"mp4"==e?"video":"image"},resultSrc:function(){return"/watermark/".concat(this.result)}},methods:{handleUploaded:function(t){this.step=1,t.success&&(this.src=t.data)},handleUploadError:function(){this.$Message.error("上传失败，请检查网络设置")},handleDesignEnd:function(){var t=this;this.designing=!0,h({url:"/watermark/generate",method:"post",params:Object.assign({src:this.src},this.$refs.designer.config())}).then((function(e){t.designing=!1,e.success&&(t.step=2,t.result=e.data)})).catch((function(){t.designing=!1}))},handleDownload:function(){window.open(this.resultSrc)}}},x=y,_=(n("034f"),Object(f["a"])(x,s,a,!1,null,null,null)),b=_.exports,w=n("f825"),S=n.n(w);n("f8ce");o["default"].config.productionTip=!1,o["default"].use(S.a),new o["default"]({render:function(t){return t(b)}}).$mount("#app")},"66b2":function(t,e,n){"use strict";var o=n("2e96"),s=n.n(o);s.a},"85ec":function(t,e,n){}});
//# sourceMappingURL=app.58b94347.js.map